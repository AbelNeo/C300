<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Video | FootMaster Pro</title>
      <link rel="stylesheet" href="css/styles.css">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .video-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .video-player {
            width: 100%;
            height: 450px;
            background-color: #000;
        }
        .video-info {
            padding: 1rem 0;
        }
    </style>
</head>
<body>
    <div class="video-container">
        <div class="video-player">
            <!-- Video player would go here -->
            <p style="color: white; text-align: center; line-height: 450px;">
                Video Player for: <span id="player-id"></span>
            </p>
        </div>
        <div class="video-info">
            <h2 id="video-title">Video Title</h2>
            <p id="video-description">Video description goes here</p>
            <button id="goBackButton" class="back-link"> ← Back to Previous Page </button>
        </div>
    </div>

    <script>
        // Get the player ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const playerId = urlParams.get('id');
        
        // Display the ID (in a real app, you'd fetch video data based on this ID)
        document.getElementById('player-id').textContent = decodeURIComponent(playerId);
        
        // You would typically fetch video data here based on playerId
        // For now we'll just set some placeholder text
        document.getElementById('video-title').textContent = `Highlight: ${decodeURIComponent(playerId)}`;
        document.getElementById('video-description').textContent = `Best moments from ${decodeURIComponent(playerId)}'s season`;


        const backButton = document.getElementById('goBackButton');
if (backButton) {
  backButton.addEventListener('click', () => {
    const referrer = document.referrer;
    const isFromOurSite = referrer.includes(window.location.hostname);
    
    if (isFromOurSite && window.history.length > 1) {
      window.history.back();
    } else {
      window.location.href = 'index.html';
    }
  });
}
    </script>
</body>
</html>








<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Player Profile | FootMaster Pro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/styles.css">

  <script type="importmap">
    {
      "imports": {
        "firebase/app": "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"
      }
    }
  </script>
  <script type="module" src="js/firebase.js"></script>
  <script type="module" src="js/main.js"></script>
  <script type="module" src="components/navbar-component.js"></script>
  <script type="module" src="components/footer-component.js"></script>  
  <script type="module" src="uploadPlayerPhoto.js"></script>
    <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f9f9f9;
    }
    h1 {
      text-align: center;
    }
    .player-Share-Form {
      max-width: 500px;
      margin: 0 auto 30px;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px #ccc;
    }
    label {
      display: block;
      margin: 10px 0 5px;
    }
    input[type="text"],
    input[type="number"],
    textarea,
    input[type="file"] {
      width: 100%;
      padding: 8px;
      box-sizing: border-box;
      border-radius: 4px;
      border: 1px solid #ccc;
      font-size: 1em;
    }
    textarea {
      resize: vertical;
      min-height: 60px;
    }
    button, .buy-button, .edit-btn, .delete-btn {
      margin-top: 5px;
      padding: 6px 10px;
      background-color: #27ae60;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9em;
    }
    .edit-btn {
      background-color: #2980b9;
    }
    .save-btn {
      background-color: #f39c12;
    }
    .delete-btn {
      background-color: #c0392b;
    }
    table {
      width: 95%;
      margin: 0 auto;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 0 10px #ccc;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: center;
    }
    th {
      background-color: #27ae60;
      color: white;
    }
    td img {
      max-width: 80px;
      max-height: 80px;
      border-radius: 5px;
    }
    .buy-section {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .buy-section input[type="number"] {
      width: 60px;
      margin-bottom: 5px;
      padding: 5px;
    }
    .action-buttons {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .grid-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 20px;
  padding: 20px;
}

.grid-item {
  background: #fff;
  border-radius: 10px;
  padding: 15px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
}

.grid-item img {
  width: 100%;
  height: auto;
  border-radius: 6px;
}

.grid-item h3 {
  margin: 10px 0 5px;
  font-size: 1.1rem;
}

.grid-item p {
  margin: 0;
  font-size: 0.9rem;
}

  </style>

  <navbar-component></navbar-component>
</head>
<body>
  <header>
   
  </header>
  <main class="container">
    <div class="player-profile" id="profile">
      <div class="loading">Loading player...</div>
    </div>
  </main>
  <script type="module">
    import { db, auth } from './js/firebase.js';
    import { doc, getDoc, updateDoc, arrayUnion, arrayRemove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
    import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    // Get playerId from URL
    const urlParams = new URLSearchParams(window.location.search);
    const playerId = urlParams.get('id');
    const profileDiv = document.getElementById('profile');
    let currentUserUid = null;

    function playerCardHTML(player, isFavorite, loggedIn) {
      return `
        <section class="players-section" style="margin-bottom: 1.5em; display: flex; align-items: flex-start;">
          <div style="margin-right: 24px; display: flex; align-items: center;">
            <img
              id="favoriteStar"
              alt="Favorite Player"
              width="32"
              height="32"
              src="${isFavorite ? 'https://images.onefootball.com/cw/icons/star-yellow-dark.svg' : 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/59/Yellow_bordered_white_star.svg/512px-Yellow_bordered_white_star.svg.png?20221001001156'}"
              class="star-favorite${isFavorite ? ' active' : ''}"
              style="color: transparent;${loggedIn ? '' : 'display:none;'}"
              title="${isFavorite ? 'Remove from favorites' : 'Add to favorites'}"
              >
            </div>
          <div class="player-card" style="max-width: 350px; margin: 0 auto;">
              <img src="${player.photoPath || player.photoURL ||  'https://via.placeholder.com/150x180?text=No+Photo'}" alt="${player.name}" class="player-portrait" style="height: 240px;">
              <div class="player-info">
                  <h3 class="player-name">${player.name}</h3>
                  <p class="player-position">${player.position || ''}</p>
                  <p class="player-team">${player.team || ''}</p>
              </div>
          </div>
        </section>
        <div class="divider"></div>
        ${player.teams ? `
        <section class="teams-grid" style="margin-bottom:1.5em;">
            <h2 style="color:#800000; margin-bottom:16px;">Teams</h2>
            <div style="display:flex; gap:32px; flex-wrap:wrap;">
              ${player.teams.map(team => `
                <div class="player-card" style="width:160px;">
                  <img src="${team.logo || 'https://via.placeholder.com/80'}" alt="${team.name}" class="player-portrait" style="height: 80px;">
                  <div class="player-info">
                      <p class="player-team">${team.name}</p>
                  </div>
                </div>
              `).join('')}
            </div>
        </section>
        ` : ''}
        <section class="stats-container" style="background:#fff; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.07); padding:24px; max-width:650px; margin:0 auto;">
          <p class="title" style="color:#800000; font-weight: 600;">KEY STATS</p>
          <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(110px,1fr)); gap:18px; margin-top:18px;">
            <div>
                <p style="font-size:1.4em; color:#800000; font-weight:600;">${player.age || '-'}</p>
                <p>Age</p>
            </div>
            <div>
                <p style="font-size:1.2em; color:#800000;">${player.position || ''}</p>
                <p>Position</p>
            </div>
            <div>
                <p style="font-size:1.2em;">${player.country || player.nationality || '-'}</p>
                <p>Country</p>
            </div>
            <div>
                <p>${player.height || '-'}</p>
                <p>Height</p>
            </div>
            <div>
                <p>${player.weight || '-'}</p>
                <p>Weight</p>
            </div>
            <div>
                <p>${player.jerseyNumber || '-'}</p>
                <p>Jersey Number</p>
            </div>
          </div>
        </section>
      `;
    }

    
    

    // 1. Load Firestore player data
    async function loadPlayer() {
      if (!playerId) {
        profileDiv.innerHTML = '<div class="error">No player specified.</div>';
        return;
      }
      profileDiv.innerHTML = '<div class="loading">Loading player...</div>';
      const playerRef = doc(db, "Players", playerId);
      const snap = await getDoc(playerRef);
      if (!snap.exists()) {
        profileDiv.innerHTML = '<div class="error">Player not found.</div>';
        return;
      }
      const player = snap.data();

      // 2. Wait for auth state and render favorite button
      onAuthStateChanged(auth, async (user) => {
        currentUserUid = user ? user.uid : null;
        let isFavorite = false;
        if (user) {
          const userDoc = await getDoc(doc(db, "Accounts", currentUserUid));
          const favs = userDoc.exists() ? (userDoc.data().favoritePlayers || []) : [];
          isFavorite = favs.includes(playerId);
        }
        profileDiv.innerHTML = playerCardHTML(player, isFavorite, !!user);

        // 3. Set up favorite button logic
        const star = document.getElementById('favoriteStar');
        if (star && user) {
          star.addEventListener('click', async () => {
            star.style.pointerEvents = 'none';
            const userRef = doc(db, "Accounts", currentUserUid);
            const userDoc = await getDoc(userRef);
            const favs = userDoc.exists() ? (userDoc.data().favoritePlayers || []) : [];
            try {
              if (favs.includes(playerId)) {
                await updateDoc(userRef, { favoritePlayers: arrayRemove(playerId) });
                star.classList.remove('active');
                star.src = 'https://images.onefootball.com/cw/icons/star-outline-dark.svg';
                star.title = 'Add to favorites';
              } else {
                if (favs.length >= 3) {
                  alert('You can only have up to 3 favorite players.');
                  return;
                }
                await updateDoc(userRef, { favoritePlayers: arrayUnion(playerId) });
                star.classList.add('active');
                star.src = 'https://images.onefootball.com/cw/icons/star-yellow-dark.svg';
                star.title = 'Remove from favorites';
              }
            } catch (e) {
              alert('Failed to update favorite: ' + e.message);
            } finally {
              star.style.pointerEvents = '';
            }
          });
        }
      });
    }

    loadPlayer();

    
  </script>

  
  <form id="playerPostForm">
      <h2>Share a Post</h2>
      <label for="name">Title:</label>
      <input type="text" id="name" required />

      <label for="description">Caption:</label>
      <textarea id="description" required></textarea>

      <label for="image">Upload Image:</label>
      <input type="file" id="image" accept="image/*" multiple />

      <button type="submit">Share Post</button>
    </form>

    <div id="postGrid" class="grid-container"></div>

    
  <form class="player-Share-Form" id="playerPostForm">
    <label for="name">Item Name:</label>
    <input type="text" id="name" required />

    <label for="description">Item Description:</label>
    <textarea id="description" required></textarea>

    <label for="price">Price ($):</label>
    <input type="number" id="price" step="0.01" min="0" required />

    <label for="stock">Stock Quantity:</label>
    <input type="number" id="stock" min="0" required />

    <label for="image">Upload Image:</label>
    <input type="file" id="image" accept="image/*" multiple />

    <button type="submit">Add Item</button>
  </form>

  <div id="postGrid" class="grid-container"></div>


  <table id="playerPostTable" style="display: none;">
    <thead>
      <tr>
        <th>Image</th>
        <th>Name</th>
        <th>Description</th>
        <th>Price ($)</th>
        <th>Stock</th>
        <th>Buy</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const form = document.getElementById('playerPostForm');
    const table = document.getElementById('playerPostTable');
    const tbody = table.querySelector('tbody');

    let storeItems = JSON.parse(localStorage.getItem('storeItems') || '[]');

    function renderTable() {
      tbody.innerHTML = '';
      storeItems.forEach((item, index) => {
        const row = document.createElement('tr');

        // Image
        const imageCell = document.createElement('td');
        if (item.images.length > 0) {
          const img = document.createElement('img');
          img.src = item.images[0];
          imageCell.appendChild(img);
        } else {
          imageCell.textContent = 'No image';
        }

        const nameCell = document.createElement('td');
        nameCell.textContent = item.name;

        const descCell = document.createElement('td');
        descCell.textContent = item.description;

        const priceCell = document.createElement('td');
        priceCell.innerHTML = `
          <span class="price-text">${item.price}</span>
          <input type="number" step="0.01" class="price-edit" value="${item.price}" style="display:none; width:60px;">
        `;

        const stockCell = document.createElement('td');
        stockCell.innerHTML = `
          <span class="stock-text">${item.stock}</span>
          <input type="number" class="stock-edit" value="${item.stock}" style="display:none; width:60px;">
        `;

        const buyCell = document.createElement('td');
        const qtyInput = document.createElement('input');
        qtyInput.type = 'number';
        qtyInput.min = 1;
        qtyInput.value = 1;

        const buyBtn = document.createElement('button');
        buyBtn.textContent = 'Buy';
        buyBtn.className = 'buy-button';

        if (item.stock <= 0) {
          buyBtn.disabled = true;
          qtyInput.disabled = true;
        }

        buyBtn.addEventListener('click', () => {
          const qty = parseInt(qtyInput.value);
          if (isNaN(qty) || qty <= 0 || qty > item.stock) {
            alert(`Invalid quantity. Only ${item.stock} in stock.`);
            return;
          }
          item.stock -= qty;
          localStorage.setItem('storeItems', JSON.stringify(storeItems));
          renderTable();
        });

        const buySection = document.createElement('div');
        buySection.className = 'buy-section';
        buySection.appendChild(qtyInput);
        buySection.appendChild(buyBtn);
        buyCell.appendChild(buySection);

        const actionCell = document.createElement('td');
        const actionButtons = document.createElement('div');
        actionButtons.className = 'action-buttons';

        // Edit
        const editBtn = document.createElement('button');
        editBtn.textContent = 'Edit';
        editBtn.className = 'edit-btn';

        editBtn.addEventListener('click', () => {
          const editing = editBtn.textContent === 'Save';
          const priceText = priceCell.querySelector('.price-text');
          const priceInput = priceCell.querySelector('.price-edit');
          const stockText = stockCell.querySelector('.stock-text');
          const stockInput = stockCell.querySelector('.stock-edit');

          if (!editing) {
            priceText.style.display = 'none';
            priceInput.style.display = 'inline-block';
            stockText.style.display = 'none';
            stockInput.style.display = 'inline-block';
            editBtn.textContent = 'Save';
            editBtn.className = 'save-btn';
          } else {
            const newPrice = parseFloat(priceInput.value).toFixed(2);
            const newStock = parseInt(stockInput.value);
            if (isNaN(newPrice) || isNaN(newStock)) return;

            item.price = newPrice;
            item.stock = newStock;
            localStorage.setItem('storeItems', JSON.stringify(storeItems));
            renderTable();
          }
        });

        // Delete
        const deleteBtn = document.createElement('button');
        deleteBtn.textContent = 'Delete';
        deleteBtn.className = 'delete-btn';

        deleteBtn.addEventListener('click', () => {
          if (confirm('Are you sure you want to delete this item?')) {
            storeItems.splice(index, 1);
            localStorage.setItem('storeItems', JSON.stringify(storeItems));
            renderTable();
          }
        });

        actionButtons.appendChild(editBtn);
        actionButtons.appendChild(deleteBtn);
        actionCell.appendChild(actionButtons);

        row.appendChild(imageCell);
        row.appendChild(nameCell);
        row.appendChild(descCell);
        row.appendChild(priceCell);
        row.appendChild(stockCell);
        row.appendChild(buyCell);
        row.appendChild(actionCell);

        tbody.appendChild(row);
      });

      table.style.display = storeItems.length ? 'table' : 'none';
    }

form.addEventListener('submit', (e) => {
  e.preventDefault();

  const name = form.name.value.trim();
  const description = form.description.value.trim();
  const price = parseFloat(form.price.value).toFixed(2);
  const stock = parseInt(form.stock.value);
  const files = form.image.files;

  const currentParams = new URLSearchParams(window.location.search);
  const playerId = currentParams.get('id');

  const imagePromises = Array.from(files).map(file => {
    return new Promise(resolve => {
      const reader = new FileReader();
      reader.onload = e => resolve(e.target.result);
      reader.readAsDataURL(file);
    });
  });

  Promise.all(imagePromises).then(images => {
    storeItems.push({ name, description, price, stock, images });
    localStorage.setItem('storeItems', JSON.stringify(storeItems));
    renderTable();
    form.reset();

    // ✅ Redirect with ID preserved
    if (playerId) {
      window.location.href = `player.html?id=${encodeURIComponent(playerId)}`;
    } else {
      // fallback just in case
      window.location.href = 'player.html';
    }
  });
});


    renderTable();
  </script>

</body>
<footer-component></footer-component>
</html>


</body>
<footer-component></footer-component>
</html> -->